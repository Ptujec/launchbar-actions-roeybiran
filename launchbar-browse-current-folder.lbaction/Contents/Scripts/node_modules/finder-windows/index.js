'use strict';
const cp = require('child_process')
const util = require('util')

const execFile = util.promisify(cp.execFile)

/**
 * @param {('first'|'all')} firstOrAll whether to get all Finder windows, or just the front most.
 * @returns {(Promise<(String[]|String)>|undefined)} A String of the POSIX path of the front most Finder window;
 * or an Array of the POSIX paths of all Finder window (the front most one will the first member in that array).
 */
module.exports = async (firstOrAll) => {
    const script = __dirname + '/bin/finder-windows.scpt';
    try {
        let stdout = await execFile('/usr/bin/osascript', [script, firstOrAll]);
        stdout = stdout.stdout.trim()
        if (stdout === 'false') {
            return undefined
        } else {
            if (firstOrAll === 'all') {
                stdout = stdout.split('\n')
            }
            return stdout
        }
    } catch (err) {
        return err
    }
}
