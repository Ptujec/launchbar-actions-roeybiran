"use strict";

const got = require("got");

/**
 * perfrom HTTP requests.
 */
module.exports = (url, options) => {
  options = Object.assign(
    {
      json: true
    },
    options
  );

  if (typeof url !== "string") {
    return Promise.reject(
      new TypeError(
        `Expected \`url\` to be a \`string\`, got \`${typeof url}\``
      )
    );
  }

  if (options.transform && typeof options.transform !== "function") {
    return Promise.reject(
      new TypeError(
        `Expected \`transform\` to be a \`function\`, got \`${typeof options.transform}\``
      )
    );
  }

  return got(url, options)
    .then(response =>
      options.transform ? options.transform(response.body) : response.body
    )
    .then(data => {
      return data;
    })
    .catch(error => {
      throw error;
    });
};
