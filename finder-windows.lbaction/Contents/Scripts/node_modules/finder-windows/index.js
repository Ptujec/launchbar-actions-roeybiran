'use strict';
const execa = require('execa')

const script = __dirname + '/bin/finder-windows.scpt';

/**
 * @returns {string} - the posix path of the frontmost Finder window.
 */
module.exports.firstFinderWindow = async () => {
    const {stdout} = await execa('osascript', [script, 'first']);
    return stdout
}

/**
 * Retreives the posix path of all Finder windows,
 * the front one will be the first in order.
 * @returns {string[]}
 */
module.exports.allFinderWindows = async () => {
    const {stdout} = await execa('osascript', [script, 'all']);
    return stdout.split('\n')
}
